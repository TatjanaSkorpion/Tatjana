
<!DOCTYPE html>
<html>
   <body>
   <h1>Web Bluetooth API access example</h1>
   <p>Scann for Estimote Proximity Beacons 2</p>
     
   <!-- JavaScript accessing Bluetooth -->
   
   <p id="name">Name:</p>
   <p id="id">ID:</p>   
      
   <script>
     
      <!-- Ask user for the permission for the Bluetooth access -->      
      button.addEventListener('pointerup', function(event) {
         
         <!-- Request Bluetooth device -->     
         navigator.bluetooth.requestDevice({ filters: [{name: "blue-beacon"}] });
         .then(device => { 
            log('> Name:             ' + device.name);
            log('> Id:               ' + device.id);
            log('> Connected:        ' + device.gatt.connected);
            document.getElementById("name").innerHTML = device.name;
            document.getElementById("id").innerHTML = device.id;
         }) 
         .catch(error => { console.log(error); });        
      });    
     
   </script>      

   <p >Search using UUID:</p>
   <p id="search-uuid">Result</p>
      
   <script>
     
      <!-- Request Bluetooth device -->     
      navigator.bluetooth.requestDevice({
         filters: [{services: [0x1234, 0x12345678, 'B9407F30-F5F8-466E-AFF9-025556B57001'] }] });                                                    
         .then(device => { 
            log('> Name:             ' + device.name);
            log('> Id:               ' + device.id);
            log('> Connected:        ' + device.gatt.connected);
            document.getElementById("search-uuid").innerHTML = device.name;
         }) 
         .catch(error => { console.log(error); });        
      });    
     
   </script>  
      
   <p id="selector">Try querySelector</p>
   <p id="dev-name">Device Name:</p>
      
   <button type="button" onclick="onButtonClick()">Button</button>
      
   <script>   
      function onButtonClick() {
         let filters = [];
         
         document.getElementById("selector").innerHTML = "Query Selector Begin";

         let filterService = document.querySelector('#service').value;
         if (filterService.startsWith('0x')) {
            filterService = parseInt(filterService);
         }
         if (filterService) {
            filters.push({services: [filterService]});
         }

         let filterName = document.querySelector('#name').value;
         if (filterName) {
            filters.push({name: filterName});
         }

         let filterNamePrefix = document.querySelector('#namePrefix').value;
         if (filterNamePrefix) {
            filters.push({namePrefix: filterNamePrefix});
         }

         let options = {};
         if (document.querySelector('#allDevices').checked) {
            options.acceptAllDevices = true;
         } else {
            options.filters = filters;
         }

         log('Requesting Bluetooth Device...');
         log('with ' + JSON.stringify(options));
         navigator.bluetooth.requestDevice(options)
         .then(device => {
            log('> Name:             ' + device.name);
            log('> Id:               ' + device.id);
            log('> Connected:        ' + device.gatt.connected);
            document.getElementById("dev-name").innerHTML = device.name;
         })
         .catch(error => {
            log('Argh! ' + error);
         });         
      }     
   </script>   
     
   </body>
</html>

